@page
@using DataBase
@model PhoneDB.Pages.PhoneDetail;

@{
    var phone = Model.Phone;

    if (phone is null)
    {
        throw new Exception();
    }

    async Task RenderPropertyRows(List<Property> properties)
    {
        @foreach (var property in properties)
        {
            <li class="list-group-item">
                <div class="row align-items-center">
                    <div class="col">
                        @(property.PropertyType.Name)
                    </div>
                    <div class="col">
                        @(property.Data.ToString())
                    </div>
                </div>
            </li>
        }
    }


 
    async Task RenderSectionHead(DataBase.Section section)
    {
        <li class="list-group-item">
            <div class="col fs-3 fw-bold">
                @(section.SectionType.Name)
            </div>
        </li>
    }
}


<div class="d-flex flex-column gap-2 pb-4">
    <h1 class="fs-3 fw-bold">Phone: @(phone.Name)</h1>

    <div class="d-flex flex-column flex-sm-row gap-2">
        <div class="flex-grow-1 align-self-stretch d-flex flex-column justify-content-center">
            <img src="https://fdn2.gsmarena.com/vv/bigpic/htc-u24-pro.jpg" class="rounded  w-sm-100" alt="...">
        </div>


        <div class="d-flex flex-wrap gap-2 flex-grow-1 justify-content-center justify-content-sm-start">
            <img src="https://fdn2.gsmarena.com/vv/bigpic/htc-u24-pro.jpg" style="max-height: 100px; width: 100px;"
                 class="rounded" alt="...">
            <img src="https://fdn2.gsmarena.com/vv/bigpic/htc-u24-pro.jpg" style="max-height: 100px; width: 100px;"
                 class="rounded" alt="...">
            <img src="https://fdn2.gsmarena.com/vv/bigpic/htc-u24-pro.jpg" style="max-height: 100px; width: 100px;"
                 class="rounded" alt="...">
            <img src="https://fdn2.gsmarena.com/vv/bigpic/htc-u24-pro.jpg" style="max-height: 100px; width: 100px;"
                 class="rounded" alt="...">
            <img src="https://fdn2.gsmarena.com/vv/bigpic/htc-u24-pro.jpg" style="max-height: 100px; width: 100px;"
                 class="rounded" alt="...">
            <img src="https://fdn2.gsmarena.com/vv/bigpic/htc-u24-pro.jpg" style="max-height: 100px; width: 100px;"
                 class="rounded" alt="...">
            <img src="https://img4.dhresource.com/webp/m/0x0/f3/albu/ry/s/13/02655e8c-7ff4-4b68-a710-407f4f7d82ef.jpg"
                 style="max-height: 100px; width: 100px;" class="rounded" alt="...">
            <img src="https://www.audilo.se/9763-large_default/smartphone-doro-8050.jpg"
                 style="max-height: 100px; width: 100px;" class="rounded" alt="...">
            <img src="https://www.audilo.se/img/p/1/2/7/4/4/12744.jpg" style="max-height: 100px; width: 100px;"
                 class="rounded" alt="...">
        </div>
    </div>


    <div class="d-flex flex-column justify gap-5 w-100">
        @foreach (var pair in Model.PropertiesPerSection)
        {
            <div class="card">
                <ul class="list-group">
                    @{ await RenderSectionHead(pair.Key); }
                    @{ await RenderPropertyRows(pair.Value); }
                </ul>
            </div>
        }
    </div>
    @if (Model.PhoneReview is not null)
    {
        <h1>Your Review</h1>
        <partial name="_ReviewCard" model="@new  ReviewCard{ PhoneReview = Model.PhoneReview, isUser = false }"/>
       
        <div class="d-flex gap-2 justify-content-between">
        <a class="btn btn-primary"  asp-page="/PhoneReview/Edit" asp-route-phoneReviewId="@(Model.PhoneReview.Id)">Edit</a>
        <a class="btn btn-danger"  asp-page="/PhoneReview/Delete" asp-route-phoneReviewId="@(Model.PhoneReview.Id)">Delete</a>  
        </div>
    }
    else
    {
        <a class="btn btn-primary" asp-page="/PhoneReview/Create" asp-route-phoneId="@(phone.Id)">Create</a>
    }
    <a class="btn btn-primary"  asp-page="/PhoneReview/Index" asp-route-phoneId="@(phone.Id)">Phone Reviews from other user</a>
    </div>
